# .htaccess (raiz)
Options -Indexes
RewriteEngine On

# --- GARANTE QUE O HEADER Authorization CHEGUE AO PHP ---
# (necessÃ¡rio em muitos ambientes Apache/Windows)
RewriteCond %{HTTP:Authorization} ^(.*)
RewriteRule ^ - [E=HTTP_AUTHORIZATION:%1]
SetEnvIf Authorization "(.*)" HTTP_AUTHORIZATION=$1
CGIPassAuth On

# --- API -> front controller (index.php) ---
RewriteRule ^api(/.*)?$ index.php [QSA,L]

# --- Raiz -> /public/index.html ---
RewriteRule ^$ public/index.html [L]
RewriteRule ^public/?$ public/index.html [L]

# --- Servir arquivos/pastas de /public se existirem ---
RewriteCond %{REQUEST_URI} !^/public/
RewriteCond %{REQUEST_URI} !^/api
RewriteCond %{DOCUMENT_ROOT}/public%{REQUEST_URI} -f [OR]
RewriteCond %{DOCUMENT_ROOT}/public%{REQUEST_URI} -d
RewriteRule ^(.*)$ public/$1 [L]

# (opcional) Fallback SPA para deep-links fora de /api e sem arquivo real:
# RewriteCond %{REQUEST_URI} !^/api
# RewriteRule ^.*$ public/index.html [L]
